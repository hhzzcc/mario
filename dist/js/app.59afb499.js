(function(i){function e(e){for(var n,d,r=e[0],l=e[1],u=e[2],y=0,p=[];y<r.length;y++)d=r[y],Object.prototype.hasOwnProperty.call(a,d)&&a[d]&&p.push(a[d][0]),a[d]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(i[n]=l[n]);o&&o(e);while(p.length)p.shift()();return s.push.apply(s,u||[]),t()}function t(){for(var i,e=0;e<s.length;e++){for(var t=s[e],n=!0,r=1;r<t.length;r++){var l=t[r];0!==a[l]&&(n=!1)}n&&(s.splice(e--,1),i=d(d.s=t[0]))}return i}var n={},a={app:0},s=[];function d(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,d),t.l=!0,t.exports}d.m=i,d.c=n,d.d=function(i,e,t){d.o(i,e)||Object.defineProperty(i,e,{enumerable:!0,get:t})},d.r=function(i){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},d.t=function(i,e){if(1&e&&(i=d(i)),8&e)return i;if(4&e&&"object"===typeof i&&i&&i.__esModule)return i;var t=Object.create(null);if(d.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:i}),2&e&&"string"!=typeof i)for(var n in i)d.d(t,n,function(e){return i[e]}.bind(null,n));return t},d.n=function(i){var e=i&&i.__esModule?function(){return i["default"]}:function(){return i};return d.d(e,"a",e),e},d.o=function(i,e){return Object.prototype.hasOwnProperty.call(i,e)},d.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var o=l;s.push([0,"chunk-vendors"]),t()})({0:function(i,e,t){i.exports=t("56d7")},"034f":function(i,e,t){"use strict";t("85ec")},"2cf9":function(i,e,t){"use strict";t("968f")},"2fd3":function(i,e,t){},"351e":function(i,e,t){},"3ab0":function(i,e,t){"use strict";t("2fd3")},4576:function(i,e,t){"use strict";t("e81c")},"4dc7":function(i,e,t){"use strict";t("351e")},"56d7":function(i,e,t){"use strict";t.r(e);t("e260"),t("e6cf"),t("cca6"),t("a79d");var n=t("2b0e"),a=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},s=[],d=(t("034f"),t("2877")),r={},l=Object(d["a"])(r,a,s,!1,null,null,null),u=l.exports,o=t("8c4f"),y=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"home"},[t("Editor",{attrs:{camera:i.camera,fps:i.fps,loaded:i.ableLoadedEditor,cameraX:i.camera?i.camera.x:0,cameraY:i.camera?i.camera.y:0,staticSprites:i.physical?i.physical.staticSprites:{}},on:{load:i.handleLoad,start:i.handleStart,"edit-start":i.handleEditStart,edit:i.handleEdit,"edit-end":i.handleEditEnd,"page-prev":i.handlePagePrev,"page-next":i.handlePageNext}})],1)},p=[],g=(t("99af"),t("d81d"),t("07ac"),t("2909")),c=t("d4ec"),h=t("bee2"),b=function(){function i(e){Object(c["a"])(this,i);var t=e.x,n=e.y,a=e.w,s=e.h;this.x=t,this.y=n,this.w=a,this.h=s}return Object(h["a"])(i,[{key:"translate",value:function(i){var e=i.x,t=i.y;this.x+=e||0,this.y+=t||0}},{key:"isInView",value:function(i){var e=this.x,t=this.y,n=this.w,a=this.h;return i.x+i.w>=e&&i.x<=e+n&&i.y+i.h>=t&&i.y<=t+a}}]),i}(),m=(t("a434"),function(){function i(e){Object(c["a"])(this,i);var t=e.x,n=e.y,a=e.w,s=e.h,d=e.backgroundImage;this.x=t||0,this.y=n||0,this.w=a,this.h=s,this.backgroundImage=d,this.sprites=[]}return Object(h["a"])(i,[{key:"add",value:function(i){for(var e=0;e<i.length;e++){var t=i[e];if(t){for(var n=0;n<this.sprites.length;n++){var a=this.sprites[n];if(t.x===a.x&&t.y===a.y&&a.ableBeCover){a.remove();break}}this.sprites.push(t),t.sprites.length&&this.add(t.sprites)}}}},{key:"remove",value:function(i){if(i)for(var e=0;e<this.sprites.length;e++)if(i===this.sprites[e]){this.sprites.splice(e,1);break}}},{key:"clear",value:function(){this.sprites=[]}}]),i}()),x=function(){function i(e){Object(c["a"])(this,i);var t=e.canvas,n=e.camera,a=e.scene,s=e.physical;this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.camera=n,this.scene=a,this.physical=s,this.screenCanvas=document.createElement("canvas"),this.screenCanvas.width=a.w,this.screenCanvas.height=a.h,this.screenCtx=this.screenCanvas.getContext("2d")}return Object(h["a"])(i,[{key:"renderCamera",value:function(i,e,t){var n=~~(i.x/i.w);t.drawImage(e.backgroundImage,0,0,i.w,i.h,n*i.w,0,i.w,i.h),t.drawImage(e.backgroundImage,0,0,i.w,i.h,(n+1)*i.w,0,i.w,i.h)}},{key:"renderScene",value:function(i,e,t,n){for(var a=e.sprites,s=0;s<a.length;s++){var d=a[s];if(i.isInView(d))if(d.isRemove)e.remove(d),s--;else{d.frameWorkCallback(e,i,t);var r=d.run(),l=r.w,u=r.h,o=r.x,y=r.y,p=r.image;d.isCrop?n.drawImage(p,0,0,l,u,o,y,l,u):n.drawImage(p,o,y,l,u)}else d.isOverflowRemove&&d.remove()}}},{key:"renderCanvas",value:function(i,e,t){var n=i.x,a=i.y,s=i.w,d=i.h;e.clearRect(0,0,s,d),e.drawImage(t,n,a,s,d,0,0,s,d)}},{key:"render",value:function(){var i=this.camera,e=this.scene,t=this.physical,n=this.screenCanvas,a=this.screenCtx,s=this.ctx;this.renderCamera(i,e,a),this.renderScene(i,e,t,a),this.renderCanvas(i,s,n)}}]),i}(),f=(t("caad"),t("2532"),t("262e")),v=t("2caf"),L=function(){function i(e){Object(c["a"])(this,i);var t=e.x,n=e.y,a=e.w,s=e.h,d=e.images,r=e.frameDelay,l=void 0===r?.1:r,u=e.frameCount,o=void 0===u?0:u,y=e.isCrop,p=void 0!==y&&y;this.x=t,this.y=n,this.w=a,this.h=s,this.images=d,this.beginX=t,this.beginY=n,this.beginW=a,this.beginH=s,this.frameDelay=l,this.frameCount=o,this.isOverflowRemove=!1,this.isRemoveBefore=!1,this.isRemove=!1,this.isCrop=p,this.ablePhysical=!0,this.ableBeCover=!1,this.sprites=[]}return Object(h["a"])(i,[{key:"run",value:function(){var i=this.x,e=this.y,t=this.w,n=this.h;this.frameCount=this.frameCount>=this.images.length-1?0:this.frameCount+this.frameDelay;var a=this.images[~~this.frameCount];return{x:i,y:e,w:t,h:n,image:a,sprite:this}}},{key:"wellRemove",value:function(){this.isRemoveBefore=!0}},{key:"remove",value:function(){this.isRemoveBefore=!0,this.isRemove=!0}},{key:"frameWorkCallback",value:function(){}}]),i}(),k={g:9.8,v0:10,personOffset:192,unit:32},w=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;Object(c["a"])(this,t);var a=i.images,s=i.x,d=i.y,r=i.w,l=void 0===r?16:r,u=i.h,o=void 0===u?16:u,y=i.vx,p=void 0===y?4:y;return n=e.call(this,{images:a,x:s,y:d,w:l,h:o}),n.vx=p,n.vy=0,n.maxJump=10,n.ableOverflowHidden=!0,n.type="bullet",n}return Object(h["a"])(t,[{key:"handleMove",value:function(){this.x+=this.vx,this.y+=this.vy}}]),t}(L),O=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;Object(c["a"])(this,t);var a=i.allImages,s=i.x,d=i.y,r=i.w,l=void 0===r?k.unit:r,u=i.h,o=void 0===u?k.unit:u;return n=e.call(this,{x:s,y:d,w:l,h:o}),n.allImages=a,n.vTop=-4,n.vLeft=-4,n.vRight=4,n.vx=0,n.vy=0,n.isAbleDoTop=!0,n.personType="base",n.type="person",n}return Object(h["a"])(t,[{key:"growToBig",value:function(){"big"!==this.personType&&"bullet"!=this.personType&&(this.y-=this.h,this.h=2*this.h,this.personType="big")}},{key:"growToBullet",value:function(){"bullet"!==this.personType&&("base"===this.personType&&(this.y-=this.h,this.h=2*this.h),this.personType="bullet")}},{key:"clear",value:function(){this.x=this.beginX,this.y=this.beginY,this.w=this.beginW,this.h=this.beginH,this.personType="base"}},{key:"shrink",value:function(){"base"!==this.personType&&(this.w=this.beginW,this.h=this.beginH,this.y+=this.h,this.personType="base")}},{key:"handleMove",value:function(){this.x+=this.vx,this.y+=this.vy}},{key:"handleRunType",value:function(){var i="Static";this.isDoTop&&this.isAbleDoTop&&(i="TopRight"),this.isDoLeft&&(i=this.isDoTop?"TopLeft":"Left"),this.isDoRight&&(i=this.isDoTop?"TopRight":"Right"),this.runType=i}},{key:"handleFire",value:function(i,e){if(this.isDoBullet&&"bullet"===this.personType&&(this.runType=this.runType.includes("Left")?"BulletLeft":"BulletRight",!this.timmer||Date.now()-this.timmer>200)){var t=this.runType.includes("Left"),n=new w({x:this.x+(t?-.5:1)*this.w,y:this.y,w:16,h:16,vx:6*(t?-1:1),images:this.allImages.bullet});i.add([n]),e.addDynamicSprite([n]),this.timmer=Date.now()}}},{key:"handleDeath",value:function(){this.isDeath&&(runType="Death")}},{key:"update",value:function(){this.images=this.allImages["".concat(this.personType,"Person").concat(this.runType)]}},{key:"frameWorkCallback",value:function(i,e,t){this.handleRunType(),this.handleFire(i,t),this.handleDeath(),this.update()}}]),t}(L),j=(t("4160"),t("159b"),function(i,e){return i.y+i.vy>e.y&&i.y+i.vy<e.y+e.h&&i.x!==e.x-i.w&&i.x!==e.x+e.w}),S=function(i,e){return i.y+i.h+i.vy>e.y&&i.y+i.h+i.vy<e.y+e.h&&i.x!==e.x-i.w&&i.x!==e.x+e.w},R=function(i,e){return i.x+i.w+i.vx>e.x&&i.x+i.w+i.vx<e.x+e.w&&i.y!==e.y-i.h&&i.y!==e.y+e.h},C=function(i,e){return i.x+i.vx>e.x&&i.x+i.vx<e.x+e.w&&i.y!==e.y-i.h&&i.y!==e.y+e.h},A=function(i,e){return(i.x+i.vx>e.x&&i.x+i.vx<e.x+e.w||i.x+i.w+i.vx>e.x&&i.x+i.w+i.vx<e.x+e.w)&&i.y!==e.y-i.h&&i.y!==e.y+e.h},B=function(i,e){return(i.y+i.vy>e.y&&i.y+i.vy<e.y+e.h||i.y+i.h+i.vy>e.y&&i.y+i.h+i.vy<e.y+e.h)&&i.x!==e.x-i.w&&i.x!==e.x+e.w},D=function(i,e){return!(i.x+i.vx>=e.x+e.w||i.x+i.vx+i.w<=e.x||i.y+i.vy>=e.y+e.h||i.y+i.vy+i.h<=e.y)},P=function(){function i(e){Object(c["a"])(this,i);var t=e.camera;this.camera=t,this.staticSprites={},this.unstableSprites={},this.dynamicSprites=[]}return Object(h["a"])(i,[{key:"addStaticSprite",value:function(i){for(var e in i){var t=i[e];this.staticSprites[e]=t;var n=t.sprites;if(n.length){for(var a={},s=0;s<n.length;s++){var d=n[s];a[d.x+","+d.y]=d}this.addStaticSprite(a)}}}},{key:"addUnstableSprite",value:function(i){for(var e in i)this.unstableSprites[e]=i[e]}},{key:"addDynamicSprite",value:function(i){var e=this;return i.forEach((function(i){i&&e.dynamicSprites.push(i)}))}},{key:"removeDynamicSprite",value:function(i){for(var e=0;e<this.dynamicSprites.length;e++)if(i===this.dynamicSprites[e]){this.dynamicSprites.splice(e,1);break}}},{key:"handleDynamicSpriteAndStaticSprite",value:function(i,e){this.handlePhysicalGravity(i),this.handlePhysicalMove(i),this.handlePhysicalCollection(i,e),i.handleMove()}},{key:"handlePhysicalGravity",value:function(i){if(i.isDoTop&&i.isAbleDoTop)return i._jumpOffset=(i._jumpOffset||0)+1,void(i._jumpOffset>=(i.maxJump||32)&&(i.isAbleDoTop=!1));i.vy=5}},{key:"handlePhysicalCollection",value:function(i,e){for(var t=k.unit,n=Math.max(~~(i.x/t)*t,0)-t,a=~~((i.x+i.w)/t)*t+t,s=~~(i.y/t)*t-t,d=~~((i.y+i.h)/t)*t+t,r=n;r<a;r+=t)for(var l=s;l<d;l+=t){var u=e[r+","+l];if(u){if(u.isRemoveBefore){delete e[r+","+l];continue}this.handleDynamicSpriteAndStaticSpriteCollection(i,u)}}}},{key:"handlePhysicalMove",value:function(i){switch(i.type){case"person":return this.handlePersonMove(i);case"bullet":return this.handleBulletMove(i)}}},{key:"handleDynamicSpriteAndStaticSpriteCollection",value:function(i,e){if(D(i,e))switch(i.type){case"person":return this.handlePersonCollectBuilding(i,e);case"bullet":return this.handleBulletCollectBuilding(i,e);case"mushroom-Bad":case"mushroom-Grow":return this.handleMushroomCollectBuilding(i,e)}}},{key:"handlePersonMove",value:function(i){i.vx=0,i.isDoTop&&i.isAbleDoTop&&(i.vy=-4),i.isDoLeft&&(i.vx=-4),i.isDoRight&&(i.vx=4)}},{key:"handleBulletMove",value:function(i){i.isDoTop&&i.isAbleDoTop&&(i.vy=-4)}},{key:"handlePersonCollectBuilding",value:function(i,e){return"building-Gold"===e.type?e.remove():"building-Flow"===e.type?(i.growToBullet(),e.remove()):(A(i,e)&&(i.vx=0),void(B(i,e)&&(j(i,e)&&(i.y=e.y+e.h,i.isAbleDoTop=!1,"base"!==i.personType&&(e.isBorn=!0),this.handleBuildingHorn(e)),S(i,e)&&(i.y=e.y-i.h,i._jumpOffset=0,i.vy=0,i.isAbleDoTop=!0))))}},{key:"handleBuildingHorn",value:function(i){if("building-Ask"===i.type){var e=this.unstableSprites[i.x+","+i.y];e&&!e.isAppear&&(e.isAppear=!0,this.dynamicSprites.push(e),delete this.unstableSprites[i.x+","+i.y])}i.horn()}},{key:"handleBulletCollectBuilding",value:function(i,e){"building-Gold"!==e.type&&"building-Flow"!==e.type&&(B(i,e)&&(j(i,e)&&(i.y=e.y+e.h,i.isDoTop=!1,i.isAbleDoTop=!1),S(i,e)&&(i.y=e.y-i.h,i.isDoTop=!0,i.isAbleDoTop=!0,i._jumpOffset=0)),A(i,e)&&(R(i,e)&&(i.x=e.x+e.w),C(i,e)&&(i.x=e.x-i.w),i.vx=0,i.vy=0,i.remove()))}},{key:"handleMushroomCollectBuilding",value:function(i,e){"building-Gold"!==e.type&&"building-Flow"!==e.type&&(B(i,e)&&(j(i,e)&&(i.y=e.y+e.h),S(i,e)&&(i.y=e.y-e.h,i.vy=0)),A(i,e)&&(i.vx=-i.vx))}},{key:"handleDynamicSpriteAndDynamicSprite",value:function(i,e){for(var t=0;t<e.length;t++){var n=e[t];if(this.camera.isInView(n)&&i!==n){if("person"===i.type){var a=i;D(a,n)&&("mushroom-Bad"===n.type&&(S(a,n)?(a.y-=20,n.death()):a.shrink()),"mushroom-Grow"===n.type&&n.ablePhysical&&(a.growToBig(),n.remove()))}if("bullet"===i.type){var s=i;D(s,n)&&"mushroom-Bad"===n.type&&(n.remove(),i.remove())}}}}},{key:"clear",value:function(){this.staticSprites={},this.unstableSprites={},this.dynamicSprites=[]}},{key:"run",value:function(){for(var i=this.staticSprites,e=this.dynamicSprites,t=0;t<e.length;t++){var n=e[t];n.isRemoveBefore||n.isRemove?(this.removeDynamicSprite(n),t--):n.ablePhysical&&(this.handleDynamicSpriteAndStaticSprite(n,i),this.handleDynamicSpriteAndDynamicSprite(n,e))}}}]),i}(),T=function(i,e,t){i["isDo".concat(e)]=t},_=function(i){var e=function(e){switch(e.preventDefault(),e.keyCode){case 38:T(i,"Top",!0);break;case 40:T(i,"Bottom",!0);break;case 37:T(i,"Left",!0);break;case 39:T(i,"Right",!0);break;case 32:T(i,"Bullet",!0)}},t=function(e){switch(e.keyCode){case 38:T(i,"Top",!1);break;case 40:T(i,"Bottom",!1);break;case 37:T(i,"Left",!1);break;case 39:T(i,"Right",!1);break;case 32:T(i,"Bullet",!1)}},n=function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),n},G=(t("ac1f"),t("5319"),t("5530")),E=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;Object(c["a"])(this,t);var a=i.images,s=i.x,d=i.y,r=i.w,l=void 0===r?k.unit:r,u=i.h,o=void 0===u?k.unit:u,y=i.ableHorn,p=i.ableBorn,g=i.type,h=void 0===g?"building":g;return n=e.call(this,{images:a,x:s,y:d,w:l,h:o}),n.ableHorn=y,n.ableBorn=p,n.isBorn=!1,n.ableBeCover=!0,n.type=h,n}return Object(h["a"])(t,[{key:"horn",value:function(){this.ableHorn&&!this.isBorn&&(this.y=this.beginY-8)}},{key:"handleRestoreHorn",value:function(){this.y!==this.beginY&&(this.y+=1)}},{key:"frameWorkCallback",value:function(i,e,t){this.handleRestoreHorn()}}]),t}(L),W=t("45eb"),M=t("7e84"),I=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;return Object(c["a"])(this,t),n=e.call(this,i),n.nothingImages=i.nothingImages,n.type="building-Ask",n}return Object(h["a"])(t,[{key:"horn",value:function(){Object(W["a"])(Object(M["a"])(t.prototype),"horn",this).call(this),this.ableHorn=!1,this.images=this.nothingImages}}]),t}(E),$=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;return Object(c["a"])(this,t),n=e.call(this,i),n.frameDelay=.05,n.type="building-Gold",n}return t}(E),H=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;return Object(c["a"])(this,t),n=e.call(this,i),n.frameDelay=.05,n.type="building-Flow",n}return t}(E),X=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;return Object(c["a"])(this,t),n=e.call(this,i),n.type="building-Stone",n}return Object(h["a"])(t,[{key:"handleBorn",value:function(i){if(this.isBorn&&this.ableBorn){this.remove();var e=this.beginX,t=this.beginY,n=this.w,a=this.h,s=this.images;n/=2,a/=2,i.add([new N({x:e,y:t,w:n,h:a,images:s,index:0}),new N({x:e+n,y:t,w:n,h:a,images:s,index:1}),new N({x:e,y:t+a,w:n,h:a,images:s,index:2}),new N({x:e+n,y:t+a,w:n,h:a,images:s,index:3})]),this.ableBorn=!1}}},{key:"frameWorkCallback",value:function(i,e,n){Object(W["a"])(Object(M["a"])(t.prototype),"frameWorkCallback",this).call(this,i,e,n),this.handleBorn(i)}}]),t}(E),N=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;Object(c["a"])(this,t);var a=i.index;return n=e.call(this,i),n.index=a,n.animatedX=0,n.animatedY=0,n.ablePhysical=!1,n.isCrop=!0,n.type="building-Born",n}return Object(h["a"])(t,[{key:"frameWorkCallback",value:function(){if(0===this.index||2===this.index){var i=0===this.index?5:3;this.animatedX+=2,this.animatedY=.1*this.animatedX*this.animatedX-i*this.animatedX,this.x=this.beginX-this.animatedX,this.y=this.beginY+this.animatedY}if(1===this.index||3===this.index){var e=1===this.index?5:3;this.animatedX+=2,this.animatedY=.1*this.animatedX*this.animatedX-e*this.animatedX,this.x=this.beginX+this.animatedX,this.y=this.beginY+this.animatedY}}}]),t}(E),Y=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;Object(c["a"])(this,t);var a=i.images,s=i.x,d=i.y,r=i.w;return n=e.call(this,Object(G["a"])(Object(G["a"])({},i),{},{images:[a[0]],x:s-r/2,y:d+22})),n.groupX=s,n.groupY=d,n.sprites.push(new E({images:[a[1]],x:s,y:d,type:"building-WinRod"})),n.allImages=a,n.type="building-Win",n.ablePhysical=!1,n.setRodCount(1),n}return Object(h["a"])(t,[{key:"getSpritesSumHeight",value:function(){return this.sprites.length*this.h}},{key:"setRodCount",value:function(i){var e,t=[];this.sprites.splice(1);for(var n=0;n<i;n++)t.push(new E({images:[this.allImages[2]],x:this.groupX,y:this.groupY+32*(n+1),type:"building-WinRod"}));return(e=this.sprites).push.apply(e,t),t}}]),t}(E),F=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;return Object(c["a"])(this,t),n=e.call(this,i),n.type="building-Normal",n}return t}(E),U=function(i,e){var t={x:i.x,y:i.y,w:k.unit,h:k.unit,images:e.building[i.type.replace("-","")],ableHorn:!1,ableBorn:!1};switch(i.type){case"building-Ask":return new I(Object(G["a"])(Object(G["a"])({},t),{},{ableHorn:!0,nothingImages:e.building.buildingNothing}));case"building-Gold":return new $(t);case"building-Flow":return new H(t);case"building-Stone":return new X(Object(G["a"])(Object(G["a"])({},t),{},{ableHorn:!0,ableBorn:!0}));case"building-Win":return new Y(t)}return new F(t)},V=function(i,e){for(var t={},n=0;n<e.length;n++){var a=e[n];t[a.x+","+a.y]=U(a,i)}return t},J=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;Object(c["a"])(this,t);var a=i.images,s=i.x,d=i.y,r=i.w,l=void 0===r?32:r,u=i.h,o=void 0===u?32:u;return n=e.call(this,{images:a,x:s,y:d,w:l,h:o,frameDelay:.01}),n.vx=-1,n.vy=0,n.isAbleMove=!0,n}return Object(h["a"])(t,[{key:"handleMove",value:function(){this.isAbleMove&&(this.x+=this.vx,this.y+=this.vy)}}]),t}(L),q=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;return Object(c["a"])(this,t),n=e.call(this,i),n.type="mushroom-Grow",n.isAbleMove=!1,n.isAppear=!1,n.ablePhysical=!1,n}return Object(h["a"])(t,[{key:"handleAppear",value:function(){var i=10;this.isAppear&&(this.y-=i,this.appearOffset=0,this.isAppear=!1),this.appearOffset<this.h-i&&(this.appearOffset++,this.y-=1),this.appearOffset>=this.h-i&&(this.isAbleMove=!0,this.ablePhysical=!0)}},{key:"frameWorkCallback",value:function(i,e,t){this.handleAppear()}}]),t}(J),z=function(i){Object(f["a"])(t,i);var e=Object(v["a"])(t);function t(i){var n;return Object(c["a"])(this,t),n=e.call(this,i),n.deathImages=i.deathImages,n.frameDelay=.05,n.type="mushroom-Bad",n}return Object(h["a"])(t,[{key:"death",value:function(){this.images=this.deathImages,this.isRemoveBefore=!0}},{key:"handleDeath",value:function(){this.isRemoveBefore&&(this.AnimatedDelay=this.AnimatedDelay||0,this.AnimatedDelay>=1?this.remove():this.AnimatedDelay+=.05)}},{key:"frameWorkCallback",value:function(){this.handleDeath()}}]),t}(J),K=function(i,e){return e.map((function(e){return new z({x:e.x,y:e.y,w:32,h:32,images:i.mushroom[e.type.replace("-","")],deathImages:i.mushroom.mushroomBadDie})}))},Q=function(i,e){var t={};return Object.values(i).forEach((function(i){"building-Ask"===i.type&&(t[i.x+","+i.y]=new q({x:i.x,y:i.y,w:32,h:32,images:e.mushroom.mushroomGrow}))})),t},Z=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"editor"},[t("Header",{attrs:{isOpenEditor:i.isOpenEditor},on:{"edit-start":i.handleEditStart,"edit-end":i.handleEditEnd,"update:isOpenEditor":function(e){i.isOpenEditor=e},"update:is-open-editor":function(e){i.isOpenEditor=e}}}),t("Maps",{attrs:{maps:i.maps,active:i.mapActive},on:{change:i.handleActiveMap,delete:i.handleDeleteMap,add:i.handleAddMap}}),t("Content",{attrs:{fps:i.fps,gridWidth:i.gridWidth,gridHeight:i.gridHeight,gridUnit:i.gridUnit,tools:i.tools,isOpenEditor:i.isOpenEditor,isLoaded:i.isLoaded},on:{"update:isOpenEditor":function(e){i.isOpenEditor=e},"update:is-open-editor":function(e){i.isOpenEditor=e},"page-prev":function(e){return i.$emit("page-prev")},"page-next":function(e){return i.$emit("page-next")},"change-grid":i.onChangeGrid,"change-tool":function(e){return i.currentTool=e}}},[t("canvas",{ref:"canvas",attrs:{width:"800",height:"480"}})])],1)},ii=[],ei=(t("a9e3"),t("1276"),t("96cf"),t("1da1")),ti={title:"地图1",mapData:[{type:"building-Land",x:0,y:416},{type:"building-Land",x:0,y:448},{type:"building-Land",x:32,y:416},{type:"building-Land",x:32,y:448},{type:"building-Land",x:64,y:416},{type:"building-Land",x:64,y:448},{type:"building-Land",x:96,y:416},{type:"building-Land",x:96,y:448},{type:"building-Land",x:128,y:416},{type:"building-Land",x:128,y:448},{type:"building-Land",x:160,y:416},{type:"building-Land",x:160,y:448},{type:"building-Land",x:192,y:416},{type:"building-Land",x:192,y:448},{type:"building-Land",x:224,y:416},{type:"building-Land",x:224,y:448},{type:"building-Land",x:256,y:416},{type:"building-Land",x:256,y:448},{type:"building-Land",x:288,y:416},{type:"building-Land",x:288,y:448},{type:"building-Land",x:320,y:416},{type:"building-Land",x:320,y:448},{type:"building-Land",x:352,y:416},{type:"building-Land",x:352,y:448},{type:"building-Land",x:384,y:416},{type:"building-Land",x:384,y:448},{type:"building-Land",x:416,y:416},{type:"building-Land",x:416,y:448},{type:"building-Land",x:448,y:416},{type:"building-Land",x:448,y:448},{type:"building-Land",x:480,y:416},{type:"building-Land",x:480,y:448},{type:"building-Land",x:512,y:416},{type:"building-Land",x:512,y:448},{type:"building-Land",x:544,y:416},{type:"building-Land",x:544,y:448},{type:"building-Land",x:576,y:416},{type:"building-Land",x:576,y:448},{type:"building-Land",x:608,y:416},{type:"building-Land",x:608,y:448},{type:"building-Stone",x:192,y:288},{type:"building-Stone",x:224,y:288},{type:"building-Stone",x:256,y:288},{type:"building-Gold",x:288,y:256},{type:"building-Gold",x:320,y:256},{type:"building-Gold",x:352,y:256},{type:"building-Gold",x:384,y:256},{type:"building-Gold",x:416,y:256},{type:"building-Gold",x:448,y:256},{type:"building-Gold",x:480,y:256},{type:"building-Gold",x:512,y:256},{type:"building-Gold",x:544,y:256},{type:"building-Gold",x:576,y:256},{type:"building-Gold",x:608,y:256},{type:"building-Gold",x:640,y:256},{type:"building-Gold",x:672,y:256},{type:"building-Gold",x:704,y:256},{type:"building-Gold",x:736,y:256},{type:"building-Gold",x:768,y:256},{type:"building-Gold",x:800,y:256},{type:"building-Gold",x:832,y:256},{type:"building-Gold",x:864,y:256},{type:"building-Gold",x:896,y:256},{type:"building-Ask",x:288,y:288},{type:"building-Ask",x:320,y:288},{type:"building-Stone",x:352,y:288},{type:"building-Stone",x:384,y:288},{type:"building-Stone",x:416,y:288},{type:"building-Ask",x:1024,y:352},{type:"building-Ask",x:1056,y:352},{type:"building-Stone",x:1088,y:288},{type:"building-Stone",x:1120,y:288},{type:"building-Stone",x:1152,y:288},{type:"building-Land",x:704,y:416},{type:"building-Land",x:704,y:448},{type:"building-Land",x:736,y:416},{type:"building-Land",x:736,y:448},{type:"building-Land",x:768,y:416},{type:"building-Land",x:768,y:448},{type:"building-Land",x:800,y:416},{type:"building-Land",x:800,y:448},{type:"building-Land",x:832,y:416},{type:"building-Land",x:832,y:448},{type:"building-Land",x:864,y:416},{type:"building-Land",x:864,y:448},{type:"building-Land",x:896,y:416},{type:"building-Land",x:896,y:448},{type:"building-Land",x:928,y:416},{type:"building-Land",x:928,y:448},{type:"building-Land",x:960,y:416},{type:"building-Land",x:960,y:448},{type:"building-Land",x:992,y:416},{type:"building-Land",x:992,y:448},{type:"building-Land",x:1024,y:416},{type:"building-Land",x:1024,y:448},{type:"building-Land",x:1056,y:416},{type:"building-Land",x:1056,y:448},{type:"building-Land",x:1088,y:416},{type:"building-Land",x:1088,y:448},{type:"building-Land",x:1120,y:416},{type:"building-Land",x:1120,y:448},{type:"building-Land",x:1152,y:416},{type:"building-Land",x:1152,y:448},{type:"building-Land",x:1184,y:416},{type:"building-Land",x:1184,y:448},{type:"building-Land",x:1216,y:416},{type:"building-Land",x:1216,y:448},{type:"building-Land",x:1248,y:416},{type:"building-Land",x:1248,y:448},{type:"building-Land",x:1280,y:416},{type:"building-Land",x:1280,y:448},{type:"building-Land",x:1312,y:416},{type:"building-Land",x:1312,y:448},{type:"building-Land",x:960,y:288},{type:"building-Land",x:960,y:320},{type:"building-Land",x:992,y:288},{type:"building-Land",x:992,y:320},{type:"building-Land",x:1024,y:288},{type:"building-Land",x:1024,y:320},{type:"building-Land",x:1056,y:288},{type:"building-Land",x:1056,y:320},{type:"building-Land",x:1088,y:288},{type:"building-Land",x:1088,y:320},{type:"building-Land",x:1120,y:288},{type:"building-Land",x:1120,y:320},{type:"building-Land",x:1152,y:288},{type:"building-Land",x:1152,y:320},{type:"building-Land",x:1184,y:288},{type:"building-Land",x:1184,y:320},{type:"building-Land",x:1216,y:288},{type:"building-Land",x:1216,y:320},{type:"building-Land",x:1248,y:288},{type:"building-Land",x:1248,y:320},{type:"building-Land",x:1280,y:288},{type:"building-Land",x:1280,y:320},{type:"building-Land",x:1312,y:288},{type:"building-Land",x:1312,y:320},{type:"building-Land",x:1344,y:288},{type:"building-Land",x:1344,y:320},{type:"building-Land",x:1376,y:288},{type:"building-Land",x:1376,y:320},{type:"building-Land",x:1408,y:288},{type:"building-Land",x:1408,y:320},{type:"building-Land",x:1440,y:288},{type:"building-Land",x:1440,y:320},{type:"building-Land",x:1472,y:288},{type:"building-Land",x:1472,y:320},{type:"building-Land",x:1504,y:288},{type:"building-Land",x:1504,y:320},{type:"building-Land",x:1536,y:288},{type:"building-Land",x:1536,y:320},{type:"building-Land",x:1568,y:288},{type:"building-Land",x:1568,y:320},{type:"building-Land",x:1600,y:288},{type:"building-Land",x:1600,y:320},{type:"building-Land",x:1632,y:288},{type:"building-Land",x:1632,y:320},{type:"building-Land",x:1664,y:288},{type:"building-Land",x:1664,y:320},{type:"building-Land",x:1696,y:288},{type:"building-Land",x:1696,y:320},{type:"building-Land",x:1728,y:288},{type:"building-Land",x:1728,y:320},{type:"building-Land",x:1760,y:288},{type:"building-Land",x:1760,y:320},{type:"building-Land",x:1792,y:288},{type:"building-Land",x:1792,y:320},{type:"building-Land",x:1824,y:288},{type:"building-Land",x:1824,y:320},{type:"building-Land",x:1856,y:288},{type:"building-Land",x:1856,y:320},{type:"building-Land",x:1888,y:288},{type:"building-Land",x:1888,y:320},{type:"building-Land",x:1920,y:288},{type:"building-Land",x:1920,y:320},{type:"building-Land",x:1952,y:288},{type:"building-Land",x:1952,y:320},{type:"building-Land",x:1984,y:288},{type:"building-Land",x:1984,y:320},{type:"building-Land",x:2016,y:288},{type:"building-Land",x:2016,y:320},{type:"building-Land",x:2048,y:288},{type:"building-Land",x:2048,y:320},{type:"building-Land",x:2080,y:288},{type:"building-Land",x:2080,y:320},{type:"building-Land",x:2112,y:288},{type:"building-Land",x:2112,y:320},{type:"building-Land",x:2144,y:288},{type:"building-Land",x:2144,y:320},{type:"building-Land",x:2176,y:288},{type:"building-Land",x:2176,y:320},{type:"building-Land",x:2208,y:288},{type:"building-Land",x:2208,y:320},{type:"building-Land",x:2240,y:288},{type:"building-Land",x:2240,y:320},{type:"building-Land",x:2272,y:288},{type:"building-Land",x:2272,y:320},{type:"building-Land",x:2304,y:288},{type:"building-Land",x:2304,y:320},{type:"building-Land",x:2336,y:288},{type:"building-Land",x:2336,y:320},{type:"building-Land",x:2368,y:288},{type:"building-Land",x:2368,y:320},{type:"building-Land",x:2400,y:288},{type:"building-Land",x:2400,y:320},{type:"building-Land",x:2432,y:288},{type:"building-Land",x:2432,y:320},{type:"building-Land",x:2464,y:288},{type:"building-Land",x:2464,y:320},{type:"building-Land",x:2496,y:288},{type:"building-Land",x:2496,y:320},{type:"building-Land",x:2528,y:288},{type:"building-Land",x:2528,y:320},{type:"building-Ask",x:320,y:384},{type:"building-Ask",x:352,y:384},{type:"building-Ask",x:544,y:384},{type:"building-Ask",x:576,y:384},{type:"building-Flow",x:544,y:352},{type:"building-Flow",x:576,y:352},{type:"building-Stone",x:192,y:128},{type:"building-Stone",x:192,y:160},{type:"building-WinRod",x:704,y:64},{type:"building-WinRod",x:704,y:96},{type:"building-WinRod",x:704,y:128},{type:"building-WinRod",x:704,y:160},{type:"building-WinRod",x:704,y:192},{type:"building-WinRod",x:704,y:224},{type:"building-WinRod",x:704,y:256},{type:"building-WinRod",x:704,y:288},{type:"building-WinRod",x:704,y:320},{type:"building-WinRod",x:704,y:352},{type:"building-WinRod",x:704,y:384},{type:"building-Win",x:704,y:32}],mushroomData:[{type:"mushroom-Bad",x:448,y:352},{type:"mushroom-Bad",x:480,y:352},{type:"mushroom-Bad",x:320,y:96}]},ni={mapData:[{type:"building-Rock",x:0,y:416},{type:"building-Rock",x:0,y:448},{type:"building-Rock",x:32,y:416},{type:"building-Rock",x:32,y:448},{type:"building-Rock",x:64,y:416},{type:"building-Rock",x:64,y:448},{type:"building-Rock",x:96,y:416},{type:"building-Rock",x:96,y:448},{type:"building-Rock",x:128,y:416},{type:"building-Rock",x:128,y:448},{type:"building-Rock",x:160,y:416},{type:"building-Rock",x:160,y:448},{type:"building-Rock",x:192,y:416},{type:"building-Rock",x:192,y:448},{type:"building-Rock",x:224,y:416},{type:"building-Rock",x:224,y:448},{type:"building-Land",x:288,y:416},{type:"building-Land",x:288,y:448},{type:"building-Land",x:320,y:416},{type:"building-Land",x:320,y:448},{type:"building-Land",x:352,y:416},{type:"building-Land",x:352,y:448},{type:"building-Land",x:384,y:416},{type:"building-Land",x:384,y:448},{type:"building-Land",x:416,y:416},{type:"building-Land",x:416,y:448},{type:"building-Land",x:448,y:416},{type:"building-Land",x:448,y:448},{type:"building-Land",x:480,y:416},{type:"building-Land",x:480,y:448},{type:"building-Land",x:512,y:416},{type:"building-Land",x:512,y:448},{type:"building-Land",x:544,y:416},{type:"building-Land",x:544,y:448},{type:"building-Land",x:576,y:416},{type:"building-Land",x:576,y:448},{type:"building-Land",x:608,y:416},{type:"building-Land",x:608,y:448},{type:"building-Stone",x:192,y:288},{type:"building-Stone",x:224,y:288},{type:"building-Stone",x:256,y:288},{type:"building-Gold",x:288,y:256},{type:"building-Gold",x:320,y:256},{type:"building-Gold",x:352,y:256},{type:"building-Gold",x:384,y:256},{type:"building-Gold",x:416,y:256},{type:"building-Gold",x:448,y:256},{type:"building-Gold",x:480,y:256},{type:"building-Gold",x:512,y:256},{type:"building-Gold",x:544,y:256},{type:"building-Gold",x:576,y:256},{type:"building-Gold",x:608,y:256},{type:"building-Gold",x:640,y:256},{type:"building-Gold",x:672,y:256},{type:"building-Gold",x:704,y:256},{type:"building-Gold",x:800,y:256},{type:"building-Gold",x:832,y:256},{type:"building-Gold",x:864,y:256},{type:"building-Gold",x:896,y:256},{type:"building-Ask",x:288,y:288},{type:"building-Ask",x:320,y:288},{type:"building-Stone",x:352,y:288},{type:"building-Stone",x:384,y:288},{type:"building-Stone",x:416,y:288},{type:"building-Ask",x:1024,y:352},{type:"building-Stone",x:1088,y:288},{type:"building-Stone",x:1152,y:288},{type:"building-Land",x:704,y:416},{type:"building-Land",x:704,y:448},{type:"building-Land",x:736,y:416},{type:"building-Land",x:736,y:448},{type:"building-Land",x:768,y:416},{type:"building-Land",x:768,y:448},{type:"building-Land",x:800,y:416},{type:"building-Land",x:1216,y:448},{type:"building-Land",x:1248,y:416},{type:"building-Land",x:1280,y:416},{type:"building-Land",x:1280,y:448},{type:"building-Land",x:1312,y:416},{type:"building-Land",x:1312,y:448},{type:"building-Land",x:960,y:288},{type:"building-Land",x:960,y:320},{type:"building-Land",x:992,y:288},{type:"building-Land",x:992,y:320},{type:"building-Land",x:1024,y:288},{type:"building-Land",x:1024,y:320},{type:"building-Land",x:1056,y:288},{type:"building-Land",x:1056,y:320},{type:"building-Land",x:1248,y:320},{type:"building-Land",x:1280,y:288},{type:"building-Land",x:1280,y:320},{type:"building-Land",x:1312,y:288},{type:"building-Land",x:1312,y:320},{type:"building-Land",x:1344,y:320},{type:"building-Land",x:1376,y:288},{type:"building-Land",x:1376,y:320},{type:"building-Land",x:1408,y:288},{type:"building-Land",x:1408,y:320},{type:"building-Land",x:1440,y:288},{type:"building-Land",x:1440,y:320},{type:"building-Land",x:1472,y:320},{type:"building-Land",x:1504,y:288},{type:"building-Land",x:1504,y:320},{type:"building-Land",x:1536,y:288},{type:"building-Land",x:1536,y:320},{type:"building-Land",x:1568,y:288},{type:"building-Land",x:1568,y:320},{type:"building-Land",x:1600,y:288},{type:"building-Land",x:1600,y:320},{type:"building-Land",x:1632,y:288},{type:"building-Land",x:1632,y:320},{type:"building-Land",x:1664,y:288},{type:"building-Land",x:1664,y:320},{type:"building-Land",x:1696,y:288},{type:"building-Land",x:1696,y:320},{type:"building-Land",x:2240,y:288},{type:"building-Land",x:2240,y:320},{type:"building-Land",x:2272,y:288},{type:"building-Land",x:2272,y:320},{type:"building-Land",x:2304,y:288},{type:"building-Land",x:2304,y:320},{type:"building-Land",x:2336,y:288},{type:"building-Land",x:2336,y:320},{type:"building-Land",x:2368,y:288},{type:"building-Land",x:2368,y:320},{type:"building-Land",x:2400,y:288},{type:"building-Land",x:2400,y:320},{type:"building-Land",x:2432,y:288},{type:"building-Land",x:2432,y:320},{type:"building-Land",x:2464,y:288},{type:"building-Land",x:2464,y:320},{type:"building-Land",x:2496,y:288},{type:"building-Land",x:2496,y:320},{type:"building-Land",x:2528,y:288},{type:"building-Land",x:2528,y:320},{type:"building-Ask",x:320,y:384},{type:"building-Ask",x:352,y:384},{type:"building-Ask",x:544,y:384},{type:"building-Ask",x:576,y:384},{type:"building-Flow",x:544,y:352},{type:"building-Flow",x:576,y:352}],mushroomData:[{type:"mushroom-Bad",x:448,y:352},{type:"mushroom-Bad",x:480,y:352},{type:"mushroom-Bad",x:320,y:96}]},ai=(t("d3b7"),t("3ca3"),t("ddb0"),t("3835")),si=function(i){return new Promise((function(e,t){var n=new Image;n.onload=function(){return e(n)},n.onerror=function(i){return t(i)},n.src=i}))},di=function(){return Promise.all([si("/imgs/persons/base/static/static.png"),si("/imgs/persons/base/jump/jump-back.png"),si("/imgs/persons/base/jump/jump-front.png"),si("/imgs/persons/base/front/frame-1.gif"),si("/imgs/persons/base/front/frame-2.gif"),si("/imgs/persons/base/front/frame-3.gif"),si("/imgs/persons/base/back/frame-1.gif"),si("/imgs/persons/base/back/frame-2.gif"),si("/imgs/persons/base/back/frame-3.gif"),si("/imgs/persons/base/die/die.png")])},ri=function(){return Promise.all([si("/imgs/persons/big/static/index.png"),si("/imgs/persons/big/jump/back.png"),si("/imgs/persons/big/jump/index.png"),si("/imgs/persons/big/front/frame-1.gif"),si("/imgs/persons/big/front/frame-2.gif"),si("/imgs/persons/big/front/frame-3.gif"),si("/imgs/persons/big/back/frame-1.gif"),si("/imgs/persons/big/back/frame-2.gif"),si("/imgs/persons/big/back/frame-3.gif")])},li=function(){return Promise.all([si("/imgs/persons/bullet/static/index.png"),si("/imgs/persons/bullet/jump/back.png"),si("/imgs/persons/bullet/jump/index.png"),si("/imgs/persons/bullet/front/frame-1.gif"),si("/imgs/persons/bullet/front/frame-2.gif"),si("/imgs/persons/bullet/front/frame-3.gif"),si("/imgs/persons/bullet/back/frame-1.gif"),si("/imgs/persons/bullet/back/frame-2.gif"),si("/imgs/persons/bullet/back/frame-3.gif"),si("/imgs/persons/bullet/bullet/back.png"),si("/imgs/persons/bullet/bullet/index.png")])},ui=function(){return Promise.all([si("/imgs/mushroom/grow/grow.png"),si("/imgs/mushroom/bad/frame-1.gif"),si("/imgs/mushroom/bad/frame-2.gif"),si("/imgs/mushroom/bad/die.gif")])},oi=function(){return Promise.all([si("/imgs/building/ask/frame-1.gif"),si("/imgs/building/ask/frame-2.gif"),si("/imgs/building/ask/frame-3.gif"),si("/imgs/building/ask/frame-4.gif"),si("/imgs/building/ask/frame-5.gif"),si("/imgs/building/ask/frame-6.gif"),si("/imgs/building/ask/nothing.png"),si("/imgs/building/land/land.png"),si("/imgs/building/stone/stone.png"),si("/imgs/building/rock/rock.png"),si("/imgs/building/gold/frame-1.gif"),si("/imgs/building/gold/frame-2.gif"),si("/imgs/building/gold/frame-3.gif"),si("/imgs/building/gold/frame-4.gif"),si("/imgs/building/gold/frame-5.gif"),si("/imgs/building/gold/frame-6.gif"),si("/imgs/building/flow/frame-1.gif"),si("/imgs/building/flow/frame-2.gif"),si("/imgs/building/flow/frame-3.gif"),si("/imgs/building/flow/frame-4.gif"),si("/imgs/building/pipe/pipelineL.png"),si("/imgs/building/pipe/pipelineR.png"),si("/imgs/building/pipe/pipelineTopL.png"),si("/imgs/building/pipe/pipelineTopR.png"),si("/imgs/building/win/flag.png"),si("/imgs/building/win/round.png"),si("/imgs/building/win/rod.png")])},yi=function(){return Promise.all([si("/imgs/bullet/frame-1.gif"),si("/imgs/bullet/frame-2.gif"),si("/imgs/bullet/frame-3.gif"),si("/imgs/bullet/frame-4.gif")])},pi=function(){return si("/imgs/scene/background.jpg")},gi=function(){var i=Object(ei["a"])(regeneratorRuntime.mark((function i(){var e,t,n,a,s,d,r,l,u,o,y,p,g,c,h,b,m,x,f,v,L,k,w,O,j,S,R,C,A,B,D,P,T,_,G,E,W,M,I,$,H,X,N,Y,F,U,V,J,q,z,K,Q,Z,ii,ei,ti,ni,si,gi,ci,hi,bi,mi,xi,fi,vi,Li,ki,wi,Oi,ji,Si,Ri,Ci,Ai,Bi,Di,Pi;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,di();case 2:return e=i.sent,t=Object(ai["a"])(e,10),n=t[0],a=t[1],s=t[2],d=t[3],r=t[4],l=t[5],u=t[6],o=t[7],y=t[8],p=t[9],i.next=16,ri();case 16:return g=i.sent,c=Object(ai["a"])(g,9),h=c[0],b=c[1],m=c[2],x=c[3],f=c[4],v=c[5],L=c[6],k=c[7],w=c[8],i.next=29,li();case 29:return O=i.sent,j=Object(ai["a"])(O,11),S=j[0],R=j[1],C=j[2],A=j[3],B=j[4],D=j[5],P=j[6],T=j[7],_=j[8],G=j[9],E=j[10],i.next=44,ui();case 44:return W=i.sent,M=Object(ai["a"])(W,4),I=M[0],$=M[1],H=M[2],X=M[3],i.next=52,oi();case 52:return N=i.sent,Y=Object(ai["a"])(N,27),F=Y[0],U=Y[1],V=Y[2],J=Y[3],q=Y[4],z=Y[5],K=Y[6],Q=Y[7],Z=Y[8],ii=Y[9],ei=Y[10],ti=Y[11],ni=Y[12],si=Y[13],gi=Y[14],ci=Y[15],hi=Y[16],bi=Y[17],mi=Y[18],xi=Y[19],fi=Y[20],vi=Y[21],Li=Y[22],ki=Y[23],wi=Y[24],Oi=Y[25],ji=Y[26],i.next=83,yi();case 83:return Si=i.sent,Ri=Object(ai["a"])(Si,4),Ci=Ri[0],Ai=Ri[1],Bi=Ri[2],Di=Ri[3],i.next=91,pi();case 91:return Pi=i.sent,i.abrupt("return",{person:{basePersonStatic:[n],basePersonTopLeft:[a],basePersonTopRight:[s],basePersonRight:[d,r,l],basePersonLeft:[u,o,y],basePersonDeath:[p],bigPersonStatic:[h],bigPersonTopLeft:[b],bigPersonTopRight:[m],bigPersonRight:[x,f,v],bigPersonLeft:[L,k,w],bulletPersonStatic:[S],bulletPersonTopLeft:[R],bulletPersonTopRight:[C],bulletPersonRight:[A,B,D],bulletPersonLeft:[P,T,_],bulletPersonBulletLeft:[G],bulletPersonBulletRight:[E],bullet:[Ci,Ai,Bi,Di]},mushroom:{mushroomGrow:[I],mushroomBad:[$,H,$],mushroomBadDie:[X]},building:{buildingAsk:[F,U,V,J,q,z],buildingNothing:[K],buildingLand:[Q],buildingStone:[Z],buildingRock:[ii],buildingGold:[ei,ti,ni,si,gi,ci],buildingFlow:[hi,bi,mi,xi],buildingPipeLeft:[fi],buildingPipeRight:[vi],buildingPipeTopLeft:[Li],buildingPipeTopRight:[ki],buildingWin:[wi,Oi,ji],buildingWinRod:[ji]},scene:{sceneBackground:[Pi]}});case 93:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}(),ci=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"editor-header"},[t("div",{staticClass:"editor-header__logo"},[i._v("超级玛丽游戏编辑器")]),t("div",{staticClass:"editor-header__edit",on:{click:i.handleEdit}},[t("Icon",{attrs:{name:"iconbianjibi"}}),i._v(" "+i._s(i.isOpenEditor?"编辑结束":"开始编辑")+" ")],1)])},hi=[],bi=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("svg",{staticClass:"icon"},[t("use",{attrs:{"xlink:href":"#"+i.name}})])},mi=[],xi={name:"icon",props:{name:{type:String,required:!0}}},fi=xi,vi=(t("3ab0"),Object(d["a"])(fi,bi,mi,!1,null,null,null)),Li=vi.exports,ki={name:"editor-header",components:{Icon:Li},props:{isOpenEditor:{type:Boolean,default:!1}},data:function(){return{isEdit:!1}},methods:{handleEdit:function(){this.isOpenEditor?this.$emit("edit-end"):this.$emit("edit-start"),this.$emit("update:isOpenEditor",!this.isOpenEditor)}}},wi=ki,Oi=(t("6629"),Object(d["a"])(wi,ci,hi,!1,null,null,null)),ji=Oi.exports,Si=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"editor-maps"},[i._l(i.maps,(function(e,n){return t("Map",{key:e.name,attrs:{map:e,active:n===i.active,ableDelete:i.maps.length>1},on:{delete:function(t){return i.$emit("delete",{map:e,i:n})}},nativeOn:{click:function(t){return i.$emit("change",{map:e,i:n})}}})})),t("Map",{attrs:{map:{title:"添加地图"},ableDelete:!1},nativeOn:{click:function(e){return i.$emit("add")}}})],2)},Ri=[],Ci=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{class:i.className},[t("div",{staticClass:"'map__title"},[i._v(i._s(i.map.title))]),i.ableDelete?t("Icon",{attrs:{name:"iconshanchu"},nativeOn:{click:function(e){return e.stopPropagation(),i.$emit("delete")}}}):i._e()],1)},Ai=[],Bi={name:"editor-map",components:{Icon:Li},props:{map:{type:Object,default:function(){return{}}},active:{type:Boolean,default:!1},ableDelete:{type:Boolean,default:!0}},computed:{className:function(){var i="map";return this.active?i+" map--active":i}}},Di=Bi,Pi=(t("cd6c"),Object(d["a"])(Di,Ci,Ai,!1,null,null,null)),Ti=Pi.exports,_i={name:"editor-maps",components:{Map:Ti},props:{active:{type:Number,default:0},maps:{type:Array,default:function(){return[]}}}},Gi=_i,Ei=(t("c3eb"),Object(d["a"])(Gi,Si,Ri,!1,null,null,null)),Wi=Ei.exports,Mi=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"editor-content"},[i.isLoaded?t("div",[t("div",{staticClass:"editor-content__game"},[i.isOpenEditor?t("span",{on:{click:function(e){return i.$emit("page-prev")}}},[i._v("←"),t("div",[i._v("相机左移")])]):i._e(),t("div",{staticClass:"editor-content__canvas"},[i._t("default"),i.fps?t("div",{staticClass:"editor-content__fps"},[i._v("fps: "+i._s(i.fps))]):i._e(),i.gridWidth&&i.isOpenEditor?t("Grids",{attrs:{width:i.gridWidth,height:i.gridHeight,unit:i.gridUnit},on:{change:function(e){return i.$emit("change-grid",e)}}}):i._e()],2),i.isOpenEditor?t("span",{on:{click:function(e){return i.$emit("page-next")}}},[i._v("→"),t("div",[i._v("相机右移")])]):i._e()]),t("div",{staticClass:"editor-content__tip",style:{paddingLeft:i.isOpenEditor?"90px":null}},[i._v(" 键盘操作：上下左右控制 空格发射子弹 ")]),i.tools.length&&i.isOpenEditor?t("Tools",{attrs:{tools:i.tools},on:{change:function(e){return i.$emit("change-tool",e)}}}):i._e()],1):t("Icon",{attrs:{name:"iconloading-copy"}})],1)},Ii=[],$i=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"editor-grids"},i._l(i.grids,(function(e){return t("div",{key:e.x+","+e.y,staticClass:"editor-grids__grid",style:{width:i.unit+"px",height:i.unit+"px"},on:{click:function(t){return i.$emit("change",e)}}})})),0)},Hi=[],Xi={name:"editor-grids",props:{width:{type:Number,default:0},height:{type:Number,default:0},unit:{type:Number,default:0}},data:function(){return{grids:[]}},mounted:function(){this.createGrid()},methods:{createGrid:function(){this.grids=[];for(var i=0;i<this.height;i+=this.unit)for(var e=0;e<this.width;e+=this.unit)this.grids.push({x:e,y:i,unit:this.unit})}}},Ni=Xi,Yi=(t("4576"),Object(d["a"])(Ni,$i,Hi,!1,null,null,null)),Fi=Yi.exports,Ui=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"editor-tools"},[t("div",{staticClass:"editor-tools__tip"},[i._v("小提示：点击下方精灵后点击上方网格可添加")]),t("div",{staticClass:"editor-tools__content"},i._l(i.tools,(function(e,n){return t("img",{key:n,staticClass:"editor-tools__tool",attrs:{src:e.image.src},on:{click:function(t){return i.handleClick(e)}}})})),0)])},Vi=[],Ji={name:"editor-tools",props:{tools:{type:Array,default:function(){return[]}}},methods:{handleClick:function(i){this.$el.parentElement.style.cursor="url(".concat(i.image.src,"), pointer"),this.$emit("change",i)}}},qi=Ji,zi=(t("4dc7"),Object(d["a"])(qi,Ui,Vi,!1,null,null,null)),Ki=zi.exports,Qi={name:"editor-content",components:{Icon:Li,Grids:Fi,Tools:Ki},props:{isLoaded:{type:Boolean,default:!1},gridWidth:{type:Number,default:0},gridHeight:{type:Number,default:0},gridUnit:{type:Number,default:0},fps:{type:Number,default:60},tools:{type:Array,default:function(){return[]}},isOpenEditor:{type:Boolean,default:!0}}},Zi=Qi,ie=(t("a3f8"),Object(d["a"])(Zi,Mi,Ii,!1,null,null,null)),ee=ie.exports,te={name:"editor",components:{Header:ji,Maps:Wi,Content:ee},props:{staticSprites:{type:Object,default:function(){return{}}},cameraX:{type:Number,default:0},cameraY:{type:Number,default:0},fps:{type:Number,default:60}},data:function(){return{maps:[Object(G["a"])({title:"地图1"},ti),Object(G["a"])({title:"地图2"},ni)],mapActive:0,gridWidth:0,gridHeight:0,gridUnit:0,currentTool:null,images:null,tools:[],isOpenEditor:!1,isLoaded:!1}},mounted:function(){console.log(ti),this.init()},methods:{init:function(){var i=this;return Object(ei["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,gi();case 2:t=e.sent,i.images=t,i.isLoaded=!0,i.$nextTick((function(){var e=i.$refs.canvas;i.gridWidth=e.width,i.gridHeight=e.height,i.gridUnit=k.unit,i.tools=[{type:"building-Stone",image:t.building.buildingStone[0]},{type:"building-Ask",image:t.building.buildingAsk[3]},{type:"building-Gold",image:t.building.buildingGold[4]},{type:"building-Land",image:t.building.buildingLand[0]},{type:"building-Rock",image:t.building.buildingRock[0]},{type:"building-PipeLeft",image:t.building.buildingPipeLeft[0]},{type:"building-PipeRight",image:t.building.buildingPipeRight[0]},{type:"building-PipeTopLeft",image:t.building.buildingPipeTopLeft[0]},{type:"building-PipeTopRight",image:t.building.buildingPipeTopRight[0]},{type:"building-Win",image:t.building.buildingWin[0]},{type:"mushroom-Bad",image:t.mushroom.mushroomBad[0]}],i.$emit("load",{images:t,map:i.maps[i.mapActive],canvas:e})}));case 6:case"end":return e.stop()}}),e)})))()},handleEditStart:function(){this.$emit("edit-start"),this.isOpenEditor=!0},handleEditEnd:function(){this.$emit("edit-end"),this.isOpenEditor=!1},handleActiveMap:function(i){i.map;var e=i.i;this.mapActive=e,this.start()},handleDeleteMap:function(i){i.map;var e=i.i;this.maps.splice(e,1),this.mapActive=Math.min(e,this.maps.length-1),this.start()},handleAddMap:function(){this.maps.push({title:"地图".concat(this.maps.length+1),mapData:[],mushroomData:[]}),this.mapActive=this.maps.length-1,this.start(),this.handleEditStart()},onChangeGrid:function(i){if(this.currentTool){var e=this.currentTool.type,t="mushroom"===e.split("-")[0]?"mushroomData":"mapData",n=this.maps[this.mapActive][t],a={type:e,x:this.cameraX+i.x,y:this.cameraY+i.y},s=this.createSprites(a);"building-Win"===e&&this.handleBuildingWin(s,n,a),n.push(a),this.$emit("edit",s)}},handleBuildingWin:function(i,e,t){for(var n=[],a=Object.values(i.buildings)[0],s=t.y;s<this.gridHeight-t.y;s+=k.unit){var d=this.staticSprites[t.x+","+(t.y+s)];if(d&&("building-Normal"===d.type||"building-Ask"===d.type||"building-Stone"===d.type)){n=a.setRodCount(s/k.unit-1);break}s===this.gridHeight-t.y-k.unit&&(n=a.setRodCount(s/k.unit))}for(var r=0;r<n.length;r++){var l=n[r];e.push({type:"building-WinRod",x:l.x,y:l.y})}},createSprites:function(i){var e=this.images,t={buildings:{},mushroomsBad:[],mushroomsGrow:[]};return i.type.includes("building")&&(t.buildings=V(e,[i]),i.type.includes("Ask")&&(t.mushroomsGrow=Q(t.buildings,e))),i.type.includes("mushroom")&&(t.mushroomsBad=K(e,[i])),t},start:function(){console.log(this.maps[this.mapActive]),this.$emit("start",this.maps[this.mapActive])}}},ne=te,ae=(t("2cf9"),Object(d["a"])(ne,Z,ii,!1,null,null,null)),se=ae.exports,de={name:"home",components:{Editor:se},data:function(){return{person:null,camera:null,scene:null,physical:null,renderer:null,images:null,canvas:null,ableStartGame:!0,ableVisiblePerson:!0,ableLoadedEditor:!1,fps:60,fpsCount:0}},methods:{handleLoad:function(i){var e=i.images,t=i.map,n=i.canvas;this.images=e,this.canvas=n,this.person=this.initPerson(),this.camera=this.initCamera(),this.scene=this.initScene(),this.physical=this.initPhysical(),this.renderer=this.initRenderer(),this.handleStart(t)},handleStart:function(i){this.clear();var e=this.createSprites(i);this.sceneAddSprite(e),this.physicalAddSprite(e),this.reRender()},handleEditStart:function(){this.camera.x=0,this.ableVisiblePerson=!1},handleEdit:function(i){this.sceneAddSprite(i,!1),this.physicalAddSprite(i,!1)},handleEditEnd:function(){this.ableVisiblePerson=!0},handlePagePrev:function(){this.camera.x=Math.max(this.camera.x-this.camera.w,0)},handlePageNext:function(){this.camera.x=Math.min(this.camera.x+this.camera.w,this.scene.w-this.camera.w)},initPerson:function(){var i=this.images,e=new O({allImages:i.person,x:k.personOffset,y:0});return _(e),e},initCamera:function(){return new b({x:0,y:0,w:this.canvas.width,h:this.canvas.height})},initScene:function(){var i=this.images;return new m({w:2*i.scene.sceneBackground[0].width,h:i.scene.sceneBackground[0].height,backgroundImage:i.scene.sceneBackground[0]})},initPhysical:function(){var i=this.scene,e=this.camera;return new P({scene:i,camera:e})},initRenderer:function(){var i=this.canvas,e=this.camera,t=this.scene,n=this.physical;return new x({canvas:i,camera:e,scene:t,physical:n})},createSprites:function(i){var e=i.mapData,t=i.mushroomData,n=this.images,a=V(n,e),s=K(n,t),d=Q(a,n);return{buildings:a,mushroomsBad:s,mushroomsGrow:d}},sceneAddSprite:function(i){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=i.buildings,n=i.mushroomsBad,a=i.mushroomsGrow;this.scene.add([].concat(Object(g["a"])(Object.values(a)),Object(g["a"])(Object.values(t)),Object(g["a"])(n),[e&&this.person]))},physicalAddSprite:function(i){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=i.buildings,n=i.mushroomsBad,a=i.mushroomsGrow;this.physical.addDynamicSprite([e&&this.person].concat(Object(g["a"])(n))),this.physical.addStaticSprite(t),this.physical.addUnstableSprite(a)},clear:function(){clearTimeout(this.timmer),this.physical.clear(),this.scene.clear(),this.person.clear()},reRender:function(){var i=this;this.ableStartGame=!1,this.timmer=setTimeout((function(){i.ableStartGame=!0,i.render()}),100)},render:function(){this.ableVisiblePerson&&(this.camera.x=Math.max(this.person.x-k.personOffset,0)),this.physical.run(),this.renderer.render(),this.fpsCount++,(!this.prevTimmer||Date.now()-this.prevTimmer>=1e3)&&(this.fps=this.fpsCount,this.fpsCount=0,this.prevTimmer=Date.now()),this.ableStartGame&&requestAnimationFrame(this.render)}}},re=de,le=(t("958c"),Object(d["a"])(re,y,p,!1,null,null,null)),ue=le.exports;n["a"].use(o["a"]);var oe=[{path:"/",name:"Home",component:ue}],ye=new o["a"]({routes:oe}),pe=ye,ge=(t("6062"),new Set),ce=function(){var i=Object(ei["a"])(regeneratorRuntime.mark((function i(e){var t;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(ge.has(e)){i.next=8;break}return t=document.createElement("script"),t.setAttribute("src",e),t.setAttribute("data-namespace",e),ge.add(e),document.body.appendChild(t),i.next=8,new Promise((function(i,e){t.onload=i,t.onerror=e}));case 8:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}(),he=function(){ce("http://at.alicdn.com/t/font_2353136_xkbqxbixob8.js")},be=function(){he()};n["a"].config.productionTip=!1,be(),new n["a"]({router:pe,render:function(i){return i(u)}}).$mount("#app")},6629:function(i,e,t){"use strict";t("6a16")},"6a16":function(i,e,t){},"7f39":function(i,e,t){},"818b":function(i,e,t){},"85ec":function(i,e,t){},"958c":function(i,e,t){"use strict";t("818b")},"968f":function(i,e,t){},"9e39":function(i,e,t){},a3f8:function(i,e,t){"use strict";t("7f39")},c3eb:function(i,e,t){"use strict";t("9e39")},cd6c:function(i,e,t){"use strict";t("d2e4")},d2e4:function(i,e,t){},e81c:function(i,e,t){}});
//# sourceMappingURL=app.59afb499.js.map